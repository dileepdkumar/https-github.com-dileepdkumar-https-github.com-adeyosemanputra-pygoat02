version: 0.2
phases: 
  install:
    on-failure: CONTINUE
    commands: 
      - "echo Entered the install phase..."
    finally: 
      - "echo This always runs even if the update or install command fails"

  pre_build: 
    commands: 
      - "echo Entered the pre_build phase..."
    finally: 
      - "echo This always runs even if the login command fails"

  build: 
    commands: 
      - "echo Entered the build phase..."
      - "echo Build started on `date`"
    finally: 
      - "echo This always runs even if the install command fails"

  post_build: 
    commands: 
      - "echo Entered the post_build phase..."
      - "echo Build completed on `date`"
      - "docker pull registry.fortidevsec.forticloud.com/fdevsec_sast:latest"
      - "docker run --rm --mount type=bind,source=$PWD,target=/scan registry.fortidevsec.forticloud.com/fdevsec_sast:latest"
  reports:
  arn:aws:codebuild:your-region:your-aws-account-id:report-group/report-group-name-1:
    files:
      - "**/*"
    base-directory: 'target/tests/reports'
    discard-paths: no
  reportGroupCucumberJson:
    files:
      - 'cucumber/target/cucumber-tests.xml'
    discard-paths: yes
    file-format: CUCUMBERJSON # default is JUNITXML
